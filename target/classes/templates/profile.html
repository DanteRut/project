<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <style>
        .role-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 1rem;
            margin: 0.25rem;
        }
        .badge-teacher { background: #4caf50; color: white; }
        .badge-student { background: #2196f3; color: white; }
        .badge-admin { background: #f44336; color: white; }
    </style>
</head>
<body>

<div th:replace="fragments/navbar"></div>

<main class="container">
    <h1>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1>

    <div th:if="${errorMessage != null}" class="alert alert-error">
        <span th:text="${errorMessage}"></span>
    </div>

    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <div sec:authorize="isAuthenticated()">
        <!-- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->

        <div th:if="${user != null}">
            <article class="card" th:object="${user}">
                <div class="grid">
                    <div>
                        <h2 th:text="*{fullName} ?: '–ù–µ —É–∫–∞–∑–∞–Ω–æ'">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                        <p><strong>–õ–æ–≥–∏–Ω:</strong> <span th:text="*{username} ?: '–ù–µ —É–∫–∞–∑–∞–Ω'">username</span></p>
                        <p><strong>Email:</strong> <span th:text="*{email} ?: '–ù–µ —É–∫–∞–∑–∞–Ω'">email</span></p>
                        <p><strong>–†–æ–ª—å:</strong>
<!--                            <span class="role-badge badge-student" th:text="*{role} ?: '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'">—Ä–æ–ª—å</span>-->
                            <span sec:authorize="hasAnyAuthority('ROLE_STUDENT')" class="role-badge badge-student">üéì –°—Ç—É–¥–µ–Ω—Ç</span>
                            <span sec:authorize="hasAnyAuthority('ROLE_TEACHER')" class="role-badge badge-teacher">üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</span>
                            <span sec:authorize="hasAnyAuthority('ROLE_ADMIN')" class="role-badge badge-admin">‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                        </p>
                        <p th:if="*{registrationDate != null}">
                            <strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong>
                            <span th:text="*{registrationDate}">–¥–∞—Ç–∞</span>
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <img src="/images/profile.png"
                             alt="–ü—Ä–æ—Ñ–∏–ª—å"
                             style="width: 150px; height: 150px; border-radius: 50%; background: #f0f0f0;"
                             onerror="this.style.display='none'">
                        <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–æ–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Spring Security -->
                        <div sec:authorize="hasAuthority('TEACHER')" class="badge primary">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</div>
                        <div sec:authorize="hasAuthority('STUDENT')" class="badge secondary">–°—Ç—É–¥–µ–Ω—Ç</div>
                        <div sec:authorize="hasAuthority('ADMIN')" class="badge contrast">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                    </div>
                </div>

                <footer class="grid">
                    <a th:href="@{/assignments/all}" role="button" class="secondary">–ö –∑–∞–¥–∞–Ω–∏—è–º</a>

                    <!-- –°—Å—ã–ª–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏ -->
                    <a th:href="@{/submissions/grades}"
                       role="button"
                       sec:authorize="hasAuthority('STUDENT')">
                        –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏
                    </a>

                    <a th:href="@{/assignments/add}"
                       role="button"
                       sec:authorize="hasAnyAuthority('TEACHER', 'ADMIN')">
                        –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                    </a>

                    <a th:href="@{/admin/dashboard}"
                       role="button"
                       sec:authorize="hasAnyAuthority('TEACHER', 'ADMIN')">
                        –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    </a>

                    <!-- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ -->
                    <a th:href="@{/admin/users}"
                       role="button"
                       sec:authorize="hasAuthority('ADMIN')"
                       class="contrast">
                        –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
                    </a>
                </footer>
            </article>
        </div>

        <div th:if="${user == null}" class="text-center">
            <article>
                <h4>–ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω</h4>
                <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ñ–∏–ª–µ.</p>
                <a th:href="@{/}" role="button">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
            </article>
        </div>
    </div>

    <!-- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω -->
    <div sec:authorize="!isAuthenticated()" class="text-center">
        <article>
            <h4>–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</h4>
            <p>–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.</p>
            <a th:href="@{/login}" role="button">–í–æ–π—Ç–∏</a>
            <a th:href="@{/register}" role="button" class="secondary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
        </article>
    </div>
</main>
</body>
</html>